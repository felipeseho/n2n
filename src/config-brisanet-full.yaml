name: "brisanet-full"
description: "Importação completa de assinaturas Brisanet"

source:
  type: "CSV"
  settings:
    FilePath: "/Users/felipeseho/Desktop/bases/full-parceiro-brisanet.csv"
    Delimiter: ";"
    StartLine: 1
    MaxLines: 100

destination:
  type: "API"
  settings:
    EndpointUrl: "https://test-seho.requestcatcher.com/"
    Method: "POST"
    Timeout: 30
    RetryAttempts: 3
    RetryDelaySeconds: 5
    MaxRequestsPerSecond: 100
    FieldMapping:
      event: "=subscription_create"
      eventDate: "start_date"
      partner: "=brisanet"
      path: "=/api/v1/events/ingest"
      payload.campaign: "campaign"
      payload.cpf: "cpf"
      payload.email: "email"
      payload.msisdn: "msisdn"
      payload.subscriptionId: "subscription_id"

processing:
  logDirectory: "logs"
  checkpointDirectory: "checkpoints"
  checkpointIntervalSeconds: 30

filters:
  - field: "campaign"
    operator: "NotEquals"
    value: "Produto Revan - sem código campanha"
  
  - field: "campaign"
    operator: "NotEquals"
    value: "#VALUE!"
    
  - field: "end_date"
    operator: "Contains"
    value: "9999"

transforms:
  - field: "email"
    type: "ToLower"
  
  - field: "campaign"
    type: "ToLower"
